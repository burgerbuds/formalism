// Variables, mixins, and functions
@import './imports/common';

// Base
.f-switch {
    $b: #{&};

    @include f-core-base;

    &__inner {
        display: inline-flex;
        flex-wrap: nowrap;
        align-items: center;
    }

    &__field {
        clip: rect(1px, 1px, 1px, 1px); // Allows tabbing still
        position: absolute;
    }

    @include f-core-label($b) {
        & {
            color: inherit;
            position: relative;
            display: flex;
            align-items: center;
            flex-wrap: nowrap;
            transition: transition(color);
            will-change: color;
        }

        // Cursors
        #{$b}__field:not(:disabled) + & {
            cursor: pointer;
        }

        #{$b}__field:disabled + & {
            cursor: not-allowed;
        }

        // The label text
        #{$b}__label-text {
            color: $f-switch-label;

            // Checked label colour
            #{$b}__field:hover + & {
                color: $f-switch-label-hover;
            }

            // Checked label colour
            #{$b}__field:checked + & {
                color: $f-switch-label-checked;
            }
        }

        // Tick + Tickbox
        &:before,
        &:after {
            content: '';
            display: block;
            font-size: $f-switch-size;
        }

        // Tickbox
        &:before {
            color: $f-switch-field-color;
            border: $f-switch-thickness solid currentColor;
            border-radius: $f-switch-field-radius;
            margin-right: $f-switch-margin-right;
            width: 1.2em;
            height: 1.2em;
            display: block;
            transition: transition(color);
            will-change: color;
            flex-shrink: 0;
        }

        // Tickbox error colours
        #{$b}__field:not([disabled])#{$f-core-error-selector} + &:before {
            color: $f-core-error-color;
        }

        #{$b}__field:disabled + &:before {
            color: $f-core-disabled-color;
        }

        // Tick
        &:after {
            transform: scaleX(-1) translate($f-switch-tick-position)
                rotate(135deg);
            transform-origin: top left;
            visibility: hidden;
            transition: transition(color);
            will-change: color;

            // Borders
            border-right: $f-switch-thickness solid currentColor;
            border-top: $f-switch-thickness solid currentColor;

            // Positioning
            position: absolute;
            left: 0;
            top: 50%;
        }

        // Tick checked
        #{$b}__field:checked + &:after {
            animation: check $f-switch-transition-duration forwards;
            visibility: visible;
            will-change: width, height;
        }

        // The checkbox animation
        // Not quite hitting 60fps but unavoidable given we're animating the width and height
        @keyframes check {
            0% {
                height: 0;
                width: 0;
            }
            25% {
                height: 0;
                width: 0.35em;
            }
            50%,
            100% {
                height: 0.7em;
                width: 0.35em;
            }
        }
    }

    @include f-core-label-text($b) {
        font-size: $f-switch-label-font-size;
        line-height: $f-switch-label-line-height;
    }

    @include f-core-indicator($b);
    @include f-core-message;
}
